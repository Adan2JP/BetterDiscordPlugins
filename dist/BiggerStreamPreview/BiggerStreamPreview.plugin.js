/**!
 * @name BiggerStreamPreview
 * @description Allows you to see bigger previews of streams via the context menu.
 * @version 1.0.4
 * @author Jaime Filho
 * @authorId 289112759948410881
 * @invite z6Yx9A8VDR
 * @website https://github.com/jaimeadf/BetterDiscordPlugins/tree/source/src/BiggerStreamPreview
 * @source https://github.com/jaimeadf/BetterDiscordPlugins/tree/source/src/BiggerStreamPreview
 * @updateUrl https://raw.githubusercontent.com/jaimeadf/BetterDiscordPlugins/dist/BiggerStreamPreview/BiggerStreamPreview.plugin.js
 */(()=>{"use strict";var e={161:(e,r,t)=>{t.d(r,{Z:()=>o});const n=global.BdApi.React;var i=t.n(n);const o=([e,r])=>{const{DiscordModules:t,WebpackModules:n,Patcher:o,DiscordContextMenu:a}=r,{StreamStore:s,StreamPreviewStore:l,ModalStack:u}=t,d=n.getByDisplayName("ImageModal"),c=n.getByDisplayName("MaskedLink");return class extends e{constructor(){super()}onStart(){this.patchUserContextMenus()}onStop(){o.unpatchAll()}patchUserContextMenus(){const e=n.findAll((e=>e.default&&e.default.displayName.includes("UserContextMenu"))),r=(e,[r],t)=>{const{user:n}=r,i=s.getStreamForUser(n.id);if(!i)return;const o=l.getPreviewURL(i.guildId,i.channelId,i.ownerId);t.props.children.props.children.push(a.buildMenuItem({type:"separator"}),a.buildMenuItem({label:"View Stream Preview",action:async()=>{await this.showImageModal(o)},disabled:null===o}))};for(const t of e)o.after(t,"default",r)}async showImageModal(e){const r=await this.fetchImage(e);u.push(d,{src:e,placeholder:e,original:e,width:r.width,height:r.height,onClickUntrusted:e=>e.openHref(),renderLinkComponent:e=>i().createElement(c,e)})}async fetchImage(e){return new Promise(((r,t)=>{const n=new Image;n.src=e,n.addEventListener("load",(()=>{r(n)})),n.addEventListener("error",(()=>{t(new Error("Image not found"))}))}))}}}},460:(e,r,t)=>{t.d(r,{default:()=>m});const n=require("fs");var i=t.n(n);const o=require("path");var a=t.n(o);const s=require("request");var l=t.n(s);const u=require("electron");var d=t.n(u);const c=global.ZeresPluginLibrary;var g=t.n(c),p=t(161);const h={info:{name:"BiggerStreamPreview",description:"Allows you to see bigger previews of streams via the context menu.",version:"1.0.4",authors:[{name:"Jaime Filho",discord_id:"289112759948410881"}],github:"https://github.com/jaimeadf/BetterDiscordPlugins/tree/source/src/BiggerStreamPreview",github_raw:"https://raw.githubusercontent.com/jaimeadf/BetterDiscordPlugins/dist/BiggerStreamPreview/BiggerStreamPreview.plugin.js"}},m=g()?(0,p.Z)(g().buildPlugin(h)):class{constructor(){this._config=h}getName(){return h.info.name}getAuthor(){return h.info.authors.map((e=>e.name)).join(", ")}getDescription(){return h.info.description}getVersion(){return h.info.version}load(){BdApi.showConfirmationModal("Library plugin is needed",`The library plugin needed for ${h.info.name} is missing. Please click Download Now to install it.`,{confirmText:"Download",cancelText:"Cancel",onConfirm(){l().get("https://rauenzi.github.io/BDPluginLibrary/release/0PluginLibrary.plugin.js",((e,r,t)=>{if(e)return d().shell.openExternal("https://betterdiscord.net/ghdl?url=https://raw.githubusercontent.com/rauenzi/BDPluginLibrary/master/release/0PluginLibrary.plugin.js");i().writeFileSync(a().join(BdApi.Plugins.folder,"0PluginLibrary.plugin.js"),t)}))}})}start(){}stop(){}}}},r={};function t(n){var i=r[n];if(void 0!==i)return i.exports;var o=r[n]={exports:{}};return e[n](o,o.exports,t),o.exports}t.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},t.d=(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),t(161);var n=t(460);module.exports=n.default})();